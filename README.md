Проект "Мессенджер": третий спринт, вторая версия

Pull-request: https://github.com/zayarnaya/middle.messenger.praktikum.yandex/pull/3

Учтены замечания ревьюера:
- использован только внутренний роутинг,
- переименована часть роутов страниц*, добавлен второй уровень к профилю и туда снесены настройки,
- для теста класса HTTPTransport использован fake API,
- по мере сил и возможностей поправлены остальные замечания, в некоторых местах оставлены ответы на комментарии (вы же можете их читать же, да?)

* Вообще мне показалось, что приведенные в ТЗ названия - это примеры, а указание - то, что каждая страница должна иметь собственный роут. А настройки профиля у меня были поименованы правильно, /settings, про сам профиль ничего в ТЗ сказано не было! ))

Также убрано навигационное оглавление, зато прикручены в верхний левый угол кнопки "назад" и "вперед" (хардкодом, просто для проверки), они годны ходить туда-обратно роутером.
Автоматического закрытия модалов после отработки нету.

Вопрос: переход полностью на внутренний роутинг потребовал дополнительной обвески и костылей, потому как на такой переход не срабатывают события смены локации(popstate, hashchange). Для роутов с переменными (переход на чат с айди) я использовала use прям в переходе, для части переходов передавала в стор новое положение и на обновление сравнивала со старым, это нормальные методы, или есть проще?
И еще. В отсутствие перезагрузки страницы у меня начали задваиваться сообщения, не очень поняла, почему так, и ввела доп. проверку. Если можно, подскажите, как следовало сделать правильно?
И еще. Опытным путем обнаружено, что компоненты input и button не желают встраиваться в шаблон, если не использован тег form, с чем это может быть связано? Button же совершенно точно может в html использоваться отдельно.



Макет в фигме https://www.figma.com/file/OrsT50kYteyyJFHShrcAYz/Chat?node-id=0%3A1

Сборка Parcel: npm run dev

Билд Parcel: npm run build

Express: npm run start

Тестирование: npm run test

Netlify: https://grand-vacherin-ee2965.netlify.app/

Для удобства просмотра приложения добавлен список ссылок на страницы (левый нижний угол).

В server.js встроена защита от DOS-атак (временный бан по айпи)

Санитайзер не писала, единственное, что напрямую вставляется в сайт, вставляется череp textContent (сообщения)

Тестируется роутер, родительский класс (Block), класс работы с запросами (HTTPTransport), функция isEmpty. Работа с запросами тестируется через свагер апи и может выдавать ошибки, если, к примеру, юзер залогинен.

Dev и Build при сборке выдают предупреждение, но собираются. Что с этим делать я не знаю, требуемый пакет я скачала, но что с ним делать не понимаю.

Мессенджер годен:
- ходить по внутренним ссылкам;
- ходить по оглавлению (для удобства просмотра, левый нижний угол);
- проверять заполнение форм;
- работать с API:
  -авторизация;
  -отправка и получение сообщений;
  -работа с данными профиля пользователя;
  -работа с чатами - завести новый чат, пригласить друга, удалить друга, поменять аватарку. Удаление чата пока не работает
- при отправке форм переходить по таймауту: 
  - со страницы входа/регистрации на страницу чатов;
  - со страницы смены пароля на страницу профиля;
- если юзер залогинен, сразу загружается страница чатов;
- если набирается необслуживаемый роутером адрес, должна выскакивать 404


Информация для начальной передачи в формы и компоненты берется из файла data.ts.

В качестве шаблонизатора использован handlebars.

В проект добавлены линтеры (ESLint, StyleLint).

Стили с первого спринта особо не менялись и местами они страшные.

Повторяющиеся компоненты заброшены в рендер немного странным образом.

Конфигурационный файл TS настроен в соответствии с требованиями, плюс добавлены флаги и библиотеки, с которыми он меньше ругается.

В качестве дизайна использовались дефолтные макеты, в процессе дорабатывались и будут еще дорабатываться.
